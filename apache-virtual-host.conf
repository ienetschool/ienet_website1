<VirtualHost *:80>
    ServerName ienet.online
    ServerAlias www.ienet.online
    
    # Redirect HTTP to HTTPS
    Redirect permanent / https://ienet.online/
</VirtualHost>

<VirtualHost *:443>
    ServerName ienet.online
    ServerAlias www.ienet.online
    
    DocumentRoot /ienet.online/public
    
    # SSL Configuration
    SSLEngine on
    SSLCertificateFile /path/to/ssl/certificate.crt
    SSLCertificateKeyFile /path/to/ssl/private.key
    
    # Proxy to Node.js application
    ProxyPreserveHost On
    ProxyRequests Off
    
    # Serve static files directly
    <Directory "/ienet.online/public">
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
    
    # Static assets with caching
    <Directory "/ienet.online/public/assets">
        ExpiresActive On
        ExpiresDefault "access plus 1 year"
        Header append Cache-Control "public, immutable"
    </Directory>
    
    # Proxy dynamic requests to Node.js
    ProxyPass /api/ http://localhost:3000/api/
    ProxyPassReverse /api/ http://localhost:3000/api/
    
    # Fallback for React routing
    <Location />
        ProxyPass http://localhost:3000/
        ProxyPassReverse http://localhost:3000/
    </Location>
    
    # Override for static files
    ProxyPass /assets/ !
    ProxyPass /favicon.ico !
    ProxyPass /robots.txt !
    
    ErrorLog ${APACHE_LOG_DIR}/ienet_error.log
    CustomLog ${APACHE_LOG_DIR}/ienet_access.log combined
</VirtualHost>