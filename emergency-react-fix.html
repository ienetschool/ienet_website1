<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    <title>IeNet - Emergency React Fix</title>
    <link rel="stylesheet" crossorigin href="/assets/index-5acz5IyP.css">
    <style>
        .emergency-fix {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #007bff;
            color: white;
            padding: 10px;
            text-align: center;
            z-index: 9999;
            font-size: 14px;
        }
        body { margin: 0; }
        #root { margin-top: 40px; }
    </style>
</head>
<body>
    <div class="emergency-fix">Emergency React Fix - Bypassing problematic code paths</div>
    <div id="root"></div>
    
    <script>
        // Emergency fix: Override any problematic authentication behavior
        console.log('Emergency React fix starting...');
        
        // Ensure the root element exists and is visible
        const rootEl = document.getElementById('root');
        if (rootEl) {
            rootEl.style.display = 'block';
            rootEl.style.minHeight = '100vh';
        }
        
        // Override fetch for auth to always return expected response
        const originalFetch = window.fetch;
        window.fetch = function(url, options) {
            if (url === '/api/auth/user' || url.includes('auth/user')) {
                console.log('Intercepting auth request for emergency fix');
                return Promise.resolve({
                    status: 401,
                    ok: false,
                    json: () => Promise.resolve({ message: 'Unauthorized' }),
                    text: () => Promise.resolve('{"message":"Unauthorized"}')
                });
            }
            return originalFetch.apply(this, arguments);
        };
        
        // Force React to render by ensuring DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', loadReact);
        } else {
            loadReact();
        }
        
        function loadReact() {
            console.log('Loading React with emergency fixes...');
            
            // Set up error handlers before loading React
            window.addEventListener('error', (e) => {
                console.error('Emergency fix caught error:', e.error);
                // Don't let errors break the app
                e.preventDefault();
            });
            
            window.addEventListener('unhandledrejection', (e) => {
                console.error('Emergency fix caught promise rejection:', e.reason);
                // Don't let promise rejections break the app
                e.preventDefault();
            });
            
            // Load the React bundle with error handling
            import('/assets/index-BOus7yXH.js')
                .then(() => {
                    console.log('React bundle loaded with emergency fixes');
                    
                    // Monitor for successful mounting
                    let attempts = 0;
                    const checkMount = setInterval(() => {
                        attempts++;
                        const root = document.getElementById('root');
                        
                        if (root && root.children.length > 0) {
                            console.log('SUCCESS: React mounted with emergency fix!');
                            document.querySelector('.emergency-fix').textContent = 'SUCCESS: React app loaded with emergency fixes!';
                            document.querySelector('.emergency-fix').style.background = '#28a745';
                            clearInterval(checkMount);
                        } else if (attempts > 20) {
                            console.error('React still not mounting after emergency fixes');
                            document.querySelector('.emergency-fix').textContent = 'Emergency fix unsuccessful - React not mounting';
                            document.querySelector('.emergency-fix').style.background = '#dc3545';
                            clearInterval(checkMount);
                        }
                    }, 1000);
                })
                .catch(error => {
                    console.error('React bundle loading failed even with emergency fix:', error);
                    document.querySelector('.emergency-fix').textContent = `Emergency fix failed: ${error.message}`;
                    document.querySelector('.emergency-fix').style.background = '#dc3545';
                });
        }
        
        // Backup plan: if React doesn't mount in 30 seconds, show static content
        setTimeout(() => {
            const root = document.getElementById('root');
            if (root && root.children.length === 0) {
                console.log('Activating static fallback...');
                root.innerHTML = `
                    <div style="padding: 40px; max-width: 1200px; margin: 0 auto; font-family: Arial, sans-serif;">
                        <div style="text-align: center; margin-bottom: 40px;">
                            <h1 style="color: #2c3e50; margin-bottom: 20px;">IeNet - IT Services & Solutions</h1>
                            <p style="font-size: 18px; color: #666;">Professional IT Services for Your Business</p>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 40px 0;">
                            <div style="background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                <h3 style="color: #007bff; margin-bottom: 15px;">Website Design & Development</h3>
                                <p>Modern, responsive websites built with the latest technologies.</p>
                            </div>
                            
                            <div style="background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                <h3 style="color: #007bff; margin-bottom: 15px;">E-commerce Solutions</h3>
                                <p>Complete online store solutions with payment integration.</p>
                            </div>
                            
                            <div style="background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                <h3 style="color: #007bff; margin-bottom: 15px;">Digital Marketing</h3>
                                <p>SEO, social media marketing, and online advertising services.</p>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin: 40px 0; padding: 30px; background: #f8f9fa; border-radius: 8px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px;">Contact Us</h2>
                            <p style="margin-bottom: 20px;">Ready to start your project? Get in touch with our team!</p>
                            <a href="/contact" style="background: #007bff; color: white; padding: 12px 30px; text-decoration: none; border-radius: 5px; display: inline-block;">Get Quote</a>
                        </div>
                    </div>
                `;
                
                document.querySelector('.emergency-fix').textContent = 'Static fallback activated - React could not mount';
                document.querySelector('.emergency-fix').style.background = '#ffc107';
            }
        }, 30000);
    </script>
</body>
</html>