# Emergency server fix for ienet.online - Run these commands immediately:

cd /var/www/vhosts/vivaindia.com/ienet.online

# Check if Node.js process is still running
ps aux | grep node
pm2 status

# Check application logs for errors
pm2 logs ienet --lines 50

# Check Nginx error logs
tail -f /var/log/nginx/error.log

# Restart the Node.js application
pm2 restart ienet

# If that doesn't work, kill and restart fresh:
pm2 delete ienet
cd /var/www/vhosts/vivaindia.com/ienet.online

# Create proper environment file
cat > .env << 'EOF'
NODE_ENV=production
PORT=3000
DATABASE_URL=mysql://netiedb:h5pLF9833@localhost:3306/ienetdb
DB_HOST=localhost
DB_PORT=3306
DB_NAME=ienetdb
DB_USER=netiedb
DB_PASSWORD=h5pLF9833
DOMAIN=ienet.online
EOF

# Start fresh with PM2
pm2 start --name "ienet" --env NODE_ENV=production -- npx tsx server/index.ts
pm2 save

# Test local connection
curl -I http://localhost:3000

# If still not working, check if files exist and rebuild:
ls -la server/index.ts
npm run build

# Alternative: Run without PM2 to see error messages
NODE_ENV=production PORT=3000 npx tsx server/index.ts

# Check what's listening on port 3000
netstat -tlnp | grep :3000

# Final test
curl -v http://ienet.online